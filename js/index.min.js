!function(){var e={keywords:"beautifulNow",limit:1},t=[],n=null,o=null,r=new AudioContext,a=null,i=document.getElementById("canvas"),s=document.getElementById("loadingBox");function l(){i.width=window.innerWidth,i.height=window.innerHeight,s.width=window.innerWidth,s.height=window.height}function c(e,t,s){var l,c,u=e.result.songs[t];new Promise(e=>{axios.get("http://www.resjs.cn:3001/lyric",{params:{id:u.id}}).then(t=>{l=t.data.lrc.lyric||"",e()})}).then(e=>new Promise(e=>{axios.get("http://resjs.cn:3001/song/detail",{params:{ids:u.id}}).then(t=>{c=t.data.songs[0].al.picUrl||"https://p1.music.126.net/ze_ggtReuHBLF2o-wUolFw==/109951163221161145.jpg",e()})})).then(e=>{var t="http://www.resjs.cn:3000/song/media/outer/url?id="+u.id;n.list.add({name:u.name,artist:u.artists[0].name,url:s?u.url:t,cover:c,lrc:l,theme:"#ebd0c2"}),n.list.switch(n.list.audios.length-1),n.audio.crossOrigin="anonymous",document.getElementsByClassName("download")[0].onclick=function(){saveAs(t)},o?o.resume():o=function(e,t,n){var o=r.createMediaElementSource(e),i=r.createAnalyser();o.connect(i),i.connect(r.destination);var s=new Uint8Array(i.frequencyBinCount);function l(){var e=t.getContext("2d"),o=t.width,r=t.height,a=e.createLinearGradient(o/6,r/2,1.5*r,o/2);a.addColorStop(0,"#c7c7f4"),a.addColorStop(.5,"#b37bf9"),a.addColorStop(1,"#c9c2e1");var l=~~(s.length/n);i.getByteFrequencyData(s),e.clearRect(0,0,o,r);for(var c=0;c<n;c++){var u=1.5*s[l*c]-5;e.fillStyle=a,e.fillRect(20+20*c,r,8,-u)}}return{play(){a=setInterval(l,1e3/60)},resume(){r.resume(),clearInterval(a)}}}(n.audio,i,180),n.play()})}function u(t,n){var o=t||e;axios.get("http://www.resjs.cn:3001/search",{params:o}).then(e=>{var t=e.data;1==o.limit&&c(t,0),n&&n(t)})}(n=new APlayer({container:document.getElementById("player"),mini:!1,autoplay:!1,theme:"#FADFA3",loop:"all",order:"random",preload:"auto",volume:.7,mutex:!0,listFolded:!1,listMaxHeight:90,lrcType:1,audio:[]})).on("canplay",function(){o.play()}),axios.interceptors.request.use(function(e){return s.style.display="block",e},function(e){return Promise.reject(e)}),axios.interceptors.response.use(function(e){return s.style.display="none",e},function(e){return Promise.reject(e)}),u(),l(),window.onresize=function(){l()},document.onclick=function(e){return e.preventDefault(),e.stopPropagation(),document.getElementsByClassName("selBox")[0].style.display="none",!1},document.getElementById("search").onclick=function(){var e=document.getElementById("musicName").value;e&&u({keywords:e,limit:10},function(e){var n;n="",(t=e).result.songs.forEach(e=>{n+=`<li class="item"><a href="javascript:void(0)">${e.name}-${e.artists[0].name}</a></li>`}),document.getElementsByClassName("selBox")[0].innerHTML=n,document.getElementsByClassName("selBox")[0].style.display="block",document.querySelectorAll(".item").forEach((e,n)=>{e.onclick=function(){c(t,n)}})})},document.ondragover=function(e){return e.preventDefault(),e.stopPropagation(),!1},document.ondrop=function(e){var t=e.dataTransfer.files[0],n=t.name;const o=new Blob([t]);return c([{name:n,singer:"",url:URL.createObjectURL(o),picLink:"",lyric:""}],0,!0),e.preventDefault(),e.stopPropagation(),!1};console.info("%cDesign by Resolve (www.resjs.cn v1.0.0)\r\n","color:#495A80;text-shadow: 0 1px 0 #ccc,0 2px 0 #c9c9c9,0 1px 0 #bbb;font-size:20px")}();